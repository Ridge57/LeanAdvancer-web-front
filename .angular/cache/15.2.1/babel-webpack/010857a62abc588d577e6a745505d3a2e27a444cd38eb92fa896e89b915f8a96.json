{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { MessageService, ConfirmationService } from 'primeng/api';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/platform-browser\";\nimport * as i2 from \"src/services/zone.service\";\nimport * as i3 from \"src/services/standard.service\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"primeng/api\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"primeng/table\";\nimport * as i8 from \"primeng/button\";\nimport * as i9 from \"primeng/toolbar\";\nimport * as i10 from \"primeng/dialog\";\nimport * as i11 from \"primeng/confirmdialog\";\nimport * as i12 from \"primeng/image\";\nimport * as i13 from \"primeng/selectbutton\";\nimport * as i14 from \"primeng/toast\";\nimport * as i15 from \"../side-navigation/side-navigation.component\";\nimport * as i16 from \"../top-navigation/top-navigation.component\";\nimport * as i17 from \"../standard-tabmenu/standard-tabmenu.component\";\nfunction StandardAjouterComponent_button_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function StandardAjouterComponent_button_16_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.ajouter());\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction StandardAjouterComponent_button_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function StandardAjouterComponent_button_17_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.annuler());\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction StandardAjouterComponent_button_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function StandardAjouterComponent_button_18_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.sauvegarder());\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction StandardAjouterComponent_div_19_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 29);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const zone_r14 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", zone_r14.idZone);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", zone_r14.nomZone, \" \");\n  }\n}\nfunction StandardAjouterComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 23)(1, \"div\", 24)(2, \"input\", 25);\n    i0.ɵɵlistener(\"input\", function StandardAjouterComponent_div_19_Template_input_input_2_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.titleChange($event.target.value));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(3, \"div\", 24)(4, \"select\", 26);\n    i0.ɵɵlistener(\"change\", function StandardAjouterComponent_div_19_Template_select_change_4_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.zoneChange($event.target.value));\n    });\n    i0.ɵɵelementStart(5, \"option\", 27);\n    i0.ɵɵtext(6, \" -- selectionner une zone -- \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, StandardAjouterComponent_div_19_option_7_Template, 2, 2, \"option\", 28);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"disabled\", ctx_r3.titre.length === 0);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.zones);\n  }\n}\nfunction StandardAjouterComponent_div_20_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function StandardAjouterComponent_div_20_ng_template_2_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r23.openNew());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(1, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function StandardAjouterComponent_div_20_ng_template_2_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r25 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r25.deleteSelectedEtapes());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r18 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", !ctx_r18.selectedEtapes || !ctx_r18.selectedEtapes.length);\n  }\n}\nfunction StandardAjouterComponent_div_20_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\");\n    i0.ɵɵelement(2, \"p-tableHeaderCheckbox\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"th\");\n    i0.ɵɵtext(4, \"Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\", 40);\n    i0.ɵɵtext(6, \"M\\u00E9dia\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"th\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction StandardAjouterComponent_div_20_ng_template_6_p_image_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"p-image\", 46);\n  }\n  if (rf & 2) {\n    const etape_r26 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"src\", etape_r26.imgUrl)(\"preview\", true);\n  }\n}\nfunction StandardAjouterComponent_div_20_ng_template_6_p_image_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r33 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"p-image\", 47);\n    i0.ɵɵlistener(\"click\", function StandardAjouterComponent_div_20_ng_template_6_p_image_7_Template_p_image_click_0_listener() {\n      i0.ɵɵrestoreView(_r33);\n      const etape_r26 = i0.ɵɵnextContext().$implicit;\n      const ctx_r31 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r31.showDisplayVideoDialog(etape_r26));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction StandardAjouterComponent_div_20_ng_template_6_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelement(1, \"i\", 40);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction StandardAjouterComponent_div_20_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r35 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵelement(2, \"p-tableCheckbox\", 29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtemplate(6, StandardAjouterComponent_div_20_ng_template_6_p_image_6_Template, 1, 2, \"p-image\", 41);\n    i0.ɵɵtemplate(7, StandardAjouterComponent_div_20_ng_template_6_p_image_7_Template, 1, 0, \"p-image\", 42);\n    i0.ɵɵtemplate(8, StandardAjouterComponent_div_20_ng_template_6_div_8_Template, 2, 0, \"div\", 43);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"button\", 44);\n    i0.ɵɵlistener(\"click\", function StandardAjouterComponent_div_20_ng_template_6_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r35);\n      const etape_r26 = restoredCtx.$implicit;\n      const ctx_r34 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r34.editEtape(etape_r26));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 45);\n    i0.ɵɵlistener(\"click\", function StandardAjouterComponent_div_20_ng_template_6_Template_button_click_11_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r35);\n      const etape_r26 = restoredCtx.$implicit;\n      const ctx_r36 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r36.deleteEtape(etape_r26));\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const etape_r26 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"value\", etape_r26);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(etape_r26.description);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", etape_r26.imgUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", etape_r26.vidUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !etape_r26.vidUrl && !etape_r26.imgUrl);\n  }\n}\nfunction StandardAjouterComponent_div_20_ng_template_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 48);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r22 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r22.etapes.length, \" \", ctx_r22.etapes.length > 1 ? \"\\u00E9tapes\" : \"\\u00E9tape\", \" \");\n  }\n}\nfunction StandardAjouterComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r38 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"p-toolbar\", 31);\n    i0.ɵɵtemplate(2, StandardAjouterComponent_div_20_ng_template_2_Template, 2, 1, \"ng-template\", 32);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p-table\", 33, 34);\n    i0.ɵɵlistener(\"selectionChange\", function StandardAjouterComponent_div_20_Template_p_table_selectionChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r38);\n      const ctx_r37 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r37.selectedEtapes = $event);\n    });\n    i0.ɵɵtemplate(5, StandardAjouterComponent_div_20_ng_template_5_Template, 8, 0, \"ng-template\", 35);\n    i0.ɵɵtemplate(6, StandardAjouterComponent_div_20_ng_template_6_Template, 12, 5, \"ng-template\", 36);\n    i0.ɵɵtemplate(7, StandardAjouterComponent_div_20_ng_template_7_Template, 2, 2, \"ng-template\", 37);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"value\", ctx_r4.etapes)(\"rows\", 100)(\"selection\", ctx_r4.selectedEtapes)(\"rowHover\", true);\n  }\n}\nfunction StandardAjouterComponent_ng_template_22_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"i\");\n  }\n  if (rf & 2) {\n    const item_r42 = ctx.$implicit;\n    i0.ɵɵclassMap(item_r42.icon);\n  }\n}\nfunction StandardAjouterComponent_ng_template_22_span_4_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 59);\n    i0.ɵɵelement(1, \"img\", 60);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r43 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", ctx_r43.etape.imgUrl, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction StandardAjouterComponent_ng_template_22_span_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r45 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"span\")(1, \"div\", 52)(2, \"div\", 53)(3, \"span\", 54);\n    i0.ɵɵtext(4, \"optionnel\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 55)(6, \"input\", 56);\n    i0.ɵɵlistener(\"change\", function StandardAjouterComponent_ng_template_22_span_4_Template_input_change_6_listener($event) {\n      i0.ɵɵrestoreView(_r45);\n      const ctx_r44 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r44.onUpload($event, \"img\"));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"label\", 57);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(9, StandardAjouterComponent_ng_template_22_span_4_div_9_Template, 2, 1, \"div\", 58);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r40 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate(ctx_r40.etape.file ? ctx_r40.etape.file.name : \"choisir une photo\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r40.etape.imgUrl);\n  }\n}\nfunction StandardAjouterComponent_ng_template_22_span_5_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 59)(1, \"video\", 63);\n    i0.ɵɵelement(2, \"source\", 18);\n    i0.ɵɵtext(3, \" Format non support\\u00E9 (.mp4 uniquement). \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r46 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", ctx_r46.etape.vidUrl, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction StandardAjouterComponent_ng_template_22_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r48 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"span\")(1, \"div\", 52)(2, \"div\", 53)(3, \"span\", 54);\n    i0.ɵɵtext(4, \"optionnel\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 55)(6, \"input\", 61);\n    i0.ɵɵlistener(\"change\", function StandardAjouterComponent_ng_template_22_span_5_Template_input_change_6_listener($event) {\n      i0.ɵɵrestoreView(_r48);\n      const ctx_r47 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r47.onUpload($event, \"vid\"));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"label\", 62);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(9, StandardAjouterComponent_ng_template_22_span_5_div_9_Template, 4, 1, \"div\", 58);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r41 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate(ctx_r41.etape.file ? ctx_r41.etape.file.name : \"charger une vid\\u00E9o\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r41.etape.vidUrl);\n  }\n}\nfunction StandardAjouterComponent_ng_template_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r50 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 49)(1, \"textarea\", 50);\n    i0.ɵɵlistener(\"ngModelChange\", function StandardAjouterComponent_ng_template_22_Template_textarea_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r50);\n      const ctx_r49 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r49.etape.description = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(2, \"p-selectButton\", 51);\n    i0.ɵɵlistener(\"ngModelChange\", function StandardAjouterComponent_ng_template_22_Template_p_selectButton_ngModelChange_2_listener($event) {\n      i0.ɵɵrestoreView(_r50);\n      const ctx_r51 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r51.selectedMedia = $event);\n    })(\"onChange\", function StandardAjouterComponent_ng_template_22_Template_p_selectButton_onChange_2_listener() {\n      i0.ɵɵrestoreView(_r50);\n      const ctx_r52 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r52.selectionMediaChange());\n    });\n    i0.ɵɵtemplate(3, StandardAjouterComponent_ng_template_22_ng_template_3_Template, 1, 2, \"ng-template\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, StandardAjouterComponent_ng_template_22_span_4_Template, 10, 2, \"span\", 43);\n    i0.ɵɵtemplate(5, StandardAjouterComponent_ng_template_22_span_5_Template, 10, 2, \"span\", 43);\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r5.etape.description);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"options\", ctx_r5.mediaOptions)(\"ngModel\", ctx_r5.selectedMedia);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.selectedMedia === \"img\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.selectedMedia === \"vid\");\n  }\n}\nfunction StandardAjouterComponent_ng_template_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r54 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 64);\n    i0.ɵɵlistener(\"click\", function StandardAjouterComponent_ng_template_23_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r54);\n      const ctx_r53 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r53.hideDialog());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(1, \"button\", 65);\n    i0.ɵɵlistener(\"click\", function StandardAjouterComponent_ng_template_23_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r54);\n      const ctx_r55 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r55.saveEtape());\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function () {\n  return {\n    marginTop: \"20px\"\n  };\n};\nconst _c1 = function () {\n  return {\n    width: \"450px\"\n  };\n};\nconst _c2 = function () {\n  return {\n    width: \"50vw\"\n  };\n};\nexport let StandardAjouterComponent = /*#__PURE__*/(() => {\n  class StandardAjouterComponent {\n    constructor(sanitizer, zoneService, standardService, formBuilder, confirmationService, messageService) {\n      this.sanitizer = sanitizer;\n      this.zoneService = zoneService;\n      this.standardService = standardService;\n      this.formBuilder = formBuilder;\n      this.confirmationService = confirmationService;\n      this.messageService = messageService;\n      this.isTitleVisible = false;\n      this.isStepListVisible = false;\n      this.titre = \"\";\n      this.selectedMedia = \"\";\n      this.toBase64 = file => new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.readAsDataURL(file);\n        reader.onload = () => resolve(reader.result);\n        reader.onerror = error => reject(error);\n      });\n    }\n    ngOnInit() {\n      this.getZones();\n      this.initForm();\n      this.etapes = [];\n      this.mediaOptions = [{\n        icon: 'pi pi-ban',\n        value: 'none'\n      }, {\n        icon: 'pi pi-image',\n        value: 'img'\n      }, {\n        icon: 'pi pi-video',\n        value: 'vid'\n      }];\n    }\n    showDisplayVideoDialog(etape) {\n      this.etape = Object.assign({}, etape);\n      this.isDisplayVideoVisible = true;\n    }\n    getZones() {\n      this.zoneService.getAllZones().subscribe(data => {\n        this.zones = data;\n      });\n    }\n    initForm() {\n      this.formStd = this.formBuilder.group({\n        titre: '',\n        etapes: [],\n        zone: this.formBuilder.group({\n          idZone: ''\n        })\n      });\n    }\n    onUpload(event, typ) {\n      this.etape.file = event.target.files[0];\n      if (typ === \"img\") {\n        this.etape.imgUrl = this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(this.etape.file));\n      } else if (typ === \"vid\") {\n        this.etape.vidUrl = this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(this.etape.file));\n      }\n    }\n    selectionMediaChange() {\n      this.etape.imgUrl = null;\n      this.etape.vidUrl = null;\n      this.etape.file = null;\n    }\n    fileChange(event) {\n      return __awaiter(this, void 0, void 0, function* () {\n        //this.uploadedFile = event.target.value\n        this.base64File = yield this.toBase64(event.target.files[0]);\n        this.formStd.get('lien').setValue(this.base64File);\n      });\n    }\n    sauvegarder() {\n      return __awaiter(this, void 0, void 0, function* () {\n        var etapesBase64File = [];\n        for (const etape of this.etapes) {\n          if (etape.file) {\n            etape.file = yield this.toBase64(etape.file);\n          }\n          etapesBase64File.push(etape);\n        }\n        this.formStd.get('etapes').setValue(etapesBase64File);\n        this.standardService.saveStandard(this.formStd.value).subscribe(() => {\n          this.formStd.reset();\n          this.etapes = [];\n        });\n      });\n    }\n    annuler() {\n      this.isTitleVisible = false;\n      this.isStepListVisible = false;\n      this.etape.file = null;\n      this.titre = \"\";\n      this.formStd.reset();\n    }\n    ajouter() {\n      this.isTitleVisible = true;\n    }\n    titleChange(val) {\n      this.titre = val;\n      this.formStd.get('titre').setValue(val);\n    }\n    zoneChange(val) {\n      this.formStd.get('zone.idZone').setValue(val);\n      this.isStepListVisible = true;\n    }\n    openNew() {\n      this.etape = {};\n      this.submitted = false;\n      this.etapeDialog = true;\n    }\n    deleteSelectedEtapes() {\n      this.confirmationService.confirm({\n        message: 'Êtes-vous sûr de vouloir supprimer cette étape ?',\n        header: 'Confirm',\n        icon: 'pi pi-exclamation-triangle',\n        accept: () => {\n          this.etapes = this.etapes.filter(val => !this.selectedEtapes.includes(val));\n          this.selectedEtapes = null;\n          this.messageService.add({\n            severity: 'success',\n            summary: 'Successful',\n            detail: 'etapes supprimées',\n            life: 3000\n          });\n        }\n      });\n    }\n    editEtape(etape) {\n      this.etape = Object.assign({}, etape);\n      if (this.etape.imgUrl) {\n        this.selectedMedia = 'img';\n      } else if (this.etape.vidUrl) {\n        this.selectedMedia = 'vid';\n      } else {\n        this.selectedMedia = 'none';\n      }\n      this.etapeDialog = true;\n    }\n    deleteEtape(etape) {\n      this.confirmationService.confirm({\n        message: \"Êtes-vous sûr de vouloir supprimer l'étape : \" + etape.description + \"?\",\n        header: 'Confirm',\n        icon: 'pi pi-exclamation-triangle',\n        accept: () => {\n          this.etapes = this.etapes.filter(val => val.id !== etape.id);\n          this.etape = {};\n          this.messageService.add({\n            severity: 'success',\n            summary: 'supprimée',\n            life: 3000\n          });\n        }\n      });\n    }\n    hideDialog() {\n      this.etape = {};\n      this.selectedMedia = \"\";\n      this.etapeDialog = false;\n      this.submitted = false;\n    }\n    saveEtape() {\n      this.submitted = true;\n      if (!this.etape.description) {\n        this.messageService.add({\n          severity: 'error',\n          detail: 'la description est obligatoire',\n          life: 3000\n        });\n      } else if (this.selectedMedia.length === 0) {\n        this.messageService.add({\n          severity: 'error',\n          detail: 'Veuillez sélectionner le type de média (aucun, image, vidéo)',\n          life: 3000\n        });\n      } else if (this.selectedMedia === 'img' && !this.etape.imgUrl) {\n        this.messageService.add({\n          severity: 'error',\n          detail: \"Veuillez insérer une image ou sélectionner l'option aucun média\",\n          life: 3000\n        });\n      } else if (this.selectedMedia === 'vid' && !this.etape.vidUrl) {\n        this.messageService.add({\n          severity: 'error',\n          detail: \"Veuillez insérer une vidéo ou sélectionner l'option aucun média\",\n          life: 3000\n        });\n      } else if (this.selectedMedia === 'vid' && this.etape.file.size > 25000000) {\n        //25MB\n        this.messageService.add({\n          severity: 'error',\n          detail: \"La vidéo dépasse la limite de 25MB\",\n          life: 3000\n        });\n      } else {\n        this.save();\n      }\n    }\n    save() {\n      if (this.etape.id) {\n        this.etapes[this.findIndexById(this.etape.id)] = this.etape;\n      } else {\n        this.etape.id = this.createId();\n        this.etapes.push(this.etape);\n      }\n      this.etapes = [...this.etapes];\n      this.etapeDialog = false;\n      this.etape = {};\n      this.selectedMedia = \"\";\n    }\n    findIndexById(id) {\n      let index = -1;\n      for (let i = 0; i < this.etapes.length; i++) {\n        if (this.etapes[i].id === id) {\n          index = i;\n          break;\n        }\n      }\n      return index;\n    }\n    createId() {\n      let id = '';\n      var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n      for (var i = 0; i < 5; i++) {\n        id += chars.charAt(Math.floor(Math.random() * chars.length));\n      }\n      return id;\n    }\n  }\n  StandardAjouterComponent.ɵfac = function StandardAjouterComponent_Factory(t) {\n    return new (t || StandardAjouterComponent)(i0.ɵɵdirectiveInject(i1.DomSanitizer), i0.ɵɵdirectiveInject(i2.ZoneService), i0.ɵɵdirectiveInject(i3.StandardService), i0.ɵɵdirectiveInject(i4.FormBuilder), i0.ɵɵdirectiveInject(i5.ConfirmationService), i0.ɵɵdirectiveInject(i5.MessageService));\n  };\n  StandardAjouterComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: StandardAjouterComponent,\n    selectors: [[\"app-standard-ajouter\"]],\n    features: [i0.ɵɵProvidersFeature([MessageService, ConfirmationService])],\n    decls: 30,\n    vars: 23,\n    consts: [[\"id\", \"wrapper\"], [\"id\", \"content-wrapper\", 1, \"d-flex\", \"flex-column\"], [\"id\", \"content \"], [1, \"container-fluid\", \"col-sm-12\", \"col-lg-10\", \"mx-auto\"], [1, \"mb-4\"], [1, \"h3\", \"mb-0\", \"text-gray-800\"], [1, \"card\", \"shadow\"], [1, \"mx-3\", \"my-3\", \"row\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Nouveau\", \"icon\", \"pi pi-plus-circle\", \"class\", \"p-button-primary mr-4\", 3, \"click\", 4, \"ngIf\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Annuler\", \"icon\", \"pi pi-trash\", \"class\", \"p-button-warning mr-4\", 3, \"click\", 4, \"ngIf\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Sauvegarder\", \"icon\", \"pi pi-save\", \"class\", \"p-button-success\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"row mx-3\", 4, \"ngIf\"], [\"class\", \"card mt-2\", 4, \"ngIf\"], [\"styleClass\", \"p-fluid\", 3, \"visible\", \"header\", \"modal\", \"visibleChange\"], [\"pTemplate\", \"content\"], [\"pTemplate\", \"footer\"], [\"header\", \"\", 3, \"visible\", \"visibleChange\"], [\"controls\", \"\", \"autoplay\", \"\", 1, \"w-100\"], [\"type\", \"video/mp4\", 3, \"src\"], [1, \"text-muted\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Nouveau\", \"icon\", \"pi pi-plus-circle\", 1, \"p-button-primary\", \"mr-4\", 3, \"click\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Annuler\", \"icon\", \"pi pi-trash\", 1, \"p-button-warning\", \"mr-4\", 3, \"click\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Sauvegarder\", \"icon\", \"pi pi-save\", 1, \"p-button-success\", 3, \"click\"], [1, \"row\", \"mx-3\"], [1, \"form-group\", \"col-sm-6\"], [\"type\", \"text\", \"pInputText\", \"\", \"placeholder\", \"titre du mode op\\u00E9ratoire\", 1, \"form-control\", 3, \"input\"], [1, \"form-control\", 3, \"disabled\", \"change\"], [\"disabled\", \"\", \"selected\", \"\", \"value\", \"\", 1, \"font-italic\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [1, \"card\", \"mt-2\"], [\"styleClass\", \"mb-4\"], [\"pTemplate\", \"left\"], [\"dataKey\", \"id\", 3, \"value\", \"rows\", \"selection\", \"rowHover\", \"selectionChange\"], [\"dt\", \"\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"summary\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Ajouter une \\u00E9tape\", \"icon\", \"pi pi-plus\", 1, \"p-button-primary\", \"mx-2\", 3, \"click\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Supprimer\", \"icon\", \"pi pi-trash\", 1, \"p-button-danger\", 3, \"disabled\", \"click\"], [1, \"mx-auto\"], [\"class\", \"mx-auto\", \"alt\", \"Image\", \"width\", \"120\", \"class\", \"shadow-4\", 3, \"src\", \"preview\", 4, \"ngIf\"], [\"class\", \"mx-auto\", \"src\", \"../../assets/img/video.jpg\", \"alt\", \"video\", \"width\", \"120\", 3, \"click\", 4, \"ngIf\"], [4, \"ngIf\"], [\"pButton\", \"\", \"pRipple\", \"\", \"icon\", \"pi pi-pencil\", 1, \"p-button-rounded\", \"p-button-primary\", \"mr-2\", 3, \"click\"], [\"pButton\", \"\", \"pRipple\", \"\", \"icon\", \"pi pi-trash\", 1, \"p-button-rounded\", \"p-button-warning\", 3, \"click\"], [\"alt\", \"Image\", \"width\", \"120\", 1, \"shadow-4\", 3, \"src\", \"preview\"], [\"src\", \"../../assets/img/video.jpg\", \"alt\", \"video\", \"width\", \"120\", 1, \"mx-auto\", 3, \"click\"], [1, \"flex\", \"align-items-center\", \"justify-content-between\"], [1, \"form-group\", \"mt-2\"], [\"id\", \"exampleFormControlTextarea1\", \"rows\", \"3\", \"placeholder\", \"description\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"optionValue\", \"value\", \"optionLabel\", \"icon\", 1, \"my-2\", 3, \"options\", \"ngModel\", \"ngModelChange\", \"onChange\"], [1, \"input-group\", \"my-2\"], [1, \"input-group-prepend\"], [1, \"input-group-text\"], [1, \"custom-file\"], [\"type\", \"file\", \"accept\", \"image/*\", \"id\", \"uploadImg\", 1, \"custom-file-input\", 3, \"change\"], [\"for\", \"uploadImg\", 1, \"custom-file-label\"], [\"class\", \"d-flex justify-content-center\", 4, \"ngIf\"], [1, \"d-flex\", \"justify-content-center\"], [\"width\", \"100%\", \"alt\", \"...\", 3, \"src\"], [\"type\", \"file\", \"accept\", \"video/*\", \"id\", \"uploadVid\", 1, \"custom-file-input\", 3, \"change\"], [\"for\", \"uploadVid\", 1, \"custom-file-label\"], [\"width\", \"320\", \"height\", \"240\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Cancel\", \"icon\", \"pi pi-times\", 1, \"p-button-text\", 3, \"click\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Save\", \"icon\", \"pi pi-check\", 1, \"p-button-text\", 3, \"click\"]],\n    template: function StandardAjouterComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"app-side-navigation\");\n        i0.ɵɵelementStart(2, \"div\", 1)(3, \"div\", 2);\n        i0.ɵɵelement(4, \"app-top-navigation\");\n        i0.ɵɵelementStart(5, \"div\", 3)(6, \"div\", 4)(7, \"h3\", 5);\n        i0.ɵɵtext(8, \"Gestion des modes op\\u00E9ratoires | \");\n        i0.ɵɵelementStart(9, \"small\");\n        i0.ɵɵtext(10, \"ajouter un mode op\\u00E9ratoire\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(11, \"app-standard-tabmenu\")(12, \"p-toast\");\n        i0.ɵɵelementStart(13, \"div\", 6)(14, \"form\")(15, \"div\", 7);\n        i0.ɵɵtemplate(16, StandardAjouterComponent_button_16_Template, 1, 0, \"button\", 8);\n        i0.ɵɵtemplate(17, StandardAjouterComponent_button_17_Template, 1, 0, \"button\", 9);\n        i0.ɵɵtemplate(18, StandardAjouterComponent_button_18_Template, 1, 0, \"button\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(19, StandardAjouterComponent_div_19_Template, 8, 2, \"div\", 11);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(20, StandardAjouterComponent_div_20_Template, 8, 4, \"div\", 12);\n        i0.ɵɵelementStart(21, \"p-dialog\", 13);\n        i0.ɵɵlistener(\"visibleChange\", function StandardAjouterComponent_Template_p_dialog_visibleChange_21_listener($event) {\n          return ctx.etapeDialog = $event;\n        });\n        i0.ɵɵtemplate(22, StandardAjouterComponent_ng_template_22_Template, 6, 5, \"ng-template\", 14);\n        i0.ɵɵtemplate(23, StandardAjouterComponent_ng_template_23_Template, 2, 0, \"ng-template\", 15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(24, \"p-confirmDialog\");\n        i0.ɵɵelementStart(25, \"p-dialog\", 16);\n        i0.ɵɵlistener(\"visibleChange\", function StandardAjouterComponent_Template_p_dialog_visibleChange_25_listener($event) {\n          return ctx.isDisplayVideoVisible = $event;\n        });\n        i0.ɵɵelementStart(26, \"video\", 17);\n        i0.ɵɵelement(27, \"source\", 18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"p\", 19);\n        i0.ɵɵtext(29);\n        i0.ɵɵelementEnd()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(12);\n        i0.ɵɵstyleMap(i0.ɵɵpureFunction0(19, _c0));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isTitleVisible);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isTitleVisible);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.etapes.length > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isTitleVisible);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isStepListVisible);\n        i0.ɵɵadvance(1);\n        i0.ɵɵstyleMap(i0.ɵɵpureFunction0(20, _c1));\n        i0.ɵɵpropertyInterpolate1(\"header\", \"Etape \", ctx.etapes.length + 1, \"\");\n        i0.ɵɵproperty(\"visible\", ctx.etapeDialog)(\"modal\", true);\n        i0.ɵɵadvance(3);\n        i0.ɵɵstyleMap(i0.ɵɵpureFunction0(21, _c1));\n        i0.ɵɵadvance(1);\n        i0.ɵɵstyleMap(i0.ɵɵpureFunction0(22, _c2));\n        i0.ɵɵproperty(\"visible\", ctx.isDisplayVideoVisible);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"src\", ctx.etape ? ctx.etape.vidUrl : \"\", i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.etape ? ctx.etape.description : \"\");\n      }\n    },\n    dependencies: [i6.NgForOf, i6.NgIf, i7.Table, i5.PrimeTemplate, i7.TableCheckbox, i7.TableHeaderCheckbox, i8.ButtonDirective, i9.Toolbar, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.NgModel, i4.NgForm, i10.Dialog, i11.ConfirmDialog, i12.Image, i13.SelectButton, i14.Toast, i15.SideNavigationComponent, i16.TopNavigationComponent, i17.StandardTabmenuComponent],\n    styles: [\"[_nghost-%COMP%]     .custom-file-upload{border:1px solid #ccc;display:inline-block;padding:6px 12px;cursor:pointer}[_nghost-%COMP%]     .p-paginator .p-paginator-current{margin-left:auto}[_nghost-%COMP%]     .p-progressbar{height:.5rem;background-color:#d8dadc}[_nghost-%COMP%]     .p-progressbar .p-progressbar-value{background-color:#607d8b}[_nghost-%COMP%]     .table-header{display:flex;justify-content:space-between}[_nghost-%COMP%]     .p-calendar .p-datepicker{min-width:25rem}[_nghost-%COMP%]     .p-calendar .p-datepicker td{font-weight:400}[_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-header{padding:1rem;text-align:left;font-size:1.5rem}[_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-paginator{padding:1rem}[_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-thead>tr>th{text-align:left}[_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-tbody>tr>td{cursor:auto}[_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-dropdown-label:not(.p-placeholder){text-transform:uppercase}[_nghost-%COMP%]     .p-datatable-customers .p-datatable-tbody>tr>td .p-column-title{display:none}@media screen and (max-width: 960px){[_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-thead>tr>th, [_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-tfoot>tr>td{display:none!important}[_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-tbody>tr{border-bottom:1px solid var(--layer-2)}[_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-tbody>tr>td{text-align:left;display:block;border:0 none!important;width:100%!important;float:left;clear:left;border:0 none}[_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-tbody>tr>td .p-column-title{padding:.4rem;min-width:30%;display:inline-block;margin:-.4rem 1rem -.4rem -.4rem;font-weight:700}[_nghost-%COMP%]     .p-datatable.p-datatable-customers .p-datatable-tbody>tr>td .p-progressbar{margin-top:.5rem}}\", \"[_nghost-%COMP%]     .p-dialog .etape-image{width:150px;margin:0 auto 2rem;display:block}\"]\n  });\n  return StandardAjouterComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}